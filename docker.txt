# 1. Используем базовый образ Maven с JDK
FROM maven:3.8.1-jdk-11 AS build

# 2. Устанавливаем рабочую директорию
WORKDIR /app

# 3. Клонируем репозиторий с заглушкой (замените URL на актуальный)
RUN git clone <URL вашего репозитория>

# 4. Переходим в каталог проекта
WORKDIR /app/<имя_каталога_с_проектом>

# 5. Выполняем сборку проекта с помощью Maven
RUN mvn clean package

# 6. Используем основной образ для запуска
FROM openjdk:11-jre-slim

# 7. Устанавливаем Jolokia
COPY --from=build /app/<имя_каталога_с_проектом>/target/*.jar app.jar
ENTRYPOINT ["java", "-javaagent:/path/to/jolokia-jvm-<версия>.jar", "-jar", "app.jar"]